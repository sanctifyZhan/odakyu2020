<html>
<head>
  <title>
    Multimarker Demo
  </title>
  <meta name="Multimarker Demo" >
  <script>   //Loads multimarker file to localstorage otherwise the area preset will only look for hiro alone
  var a = window.location.toString();
  var file = a.substring(a.indexOf("?") + 1);
      var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            if(file==a){
              xobj.open('GET', 'ARjsMultiMarkerFile', true); // 
            }
            else{
              xobj.open('GET', file, true); // 
            }
          xobj.onreadystatechange = function () { 
      if (xobj.readyState == 4 && xobj.status == "200") {
        localStorage.setItem('ARjsMultiMarkerFile',xobj.responseText);
        }};
        xobj.send();
            </script>
			  
  <script src="https://aframe.io/releases/1.0.2/aframe.min.js"></script>
<!-- include ar.js -->
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/2.0.0/aframe/build/aframe-ar.js"></script>
<!-- to load .ply model -->
<script src="https://rawgit.com/donmccurdy/aframe-extras/v6.0.1/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://unpkg.com/aframe-chromakey-material/dist/aframe-chromakey-material.min.js"></script>
  


</head>


<body style='margin : 0px; overflow: hidden;'>

    <a-scene id="scene" embedded arjs='sourceType:webcam; debugUIEnabled: false; detectionMode: mono;' vr-mode-ui="enabled: false;">
	
	  <video id="ar-video" autoplay loop="true" preload="auto" src="cutA.mp4" playsinline webkit-playsinline muted>
        </video>
		
      <a-marker preset="area">
       <a-box color="tomato" position="2.4342159276022715 -0.4749316927031705 1.355608183113371" rotation="0 -90 -70"depth="2" height="2" width="2" ></a-box>
		  
		   <a-video id="aVideoHide" src="#ar-video"  position="-1 1 0" rotation="-90 0 0" height="3px" width="3px"
                material="shader: chromakey; color: 0.1 0.9 0.2"></a-video>
		
		
		
       </a-marker>
             <a-entity camera position="0 0 1"></a-entity>
            </a-scene>
			
			
    <script>
        // ビデオ格納用の変数定義を追加
        var video = null;

        AFRAME.registerComponent('registerevents', {
            init: function () {
                var marker = this.el;

                // マーカーを検出したイベントの登録
                marker.addEventListener('markerFound', function () {

                    // マーカー認識したら、ビデオ再生
                    if (video == null) {
                        video = document.querySelector('#ar-video');
                    }
                    video.play();
                });

                // マーカーを見失ったイベントの登録
                marker.addEventListener('markerLost', function () {

                    // マーカー認識が外れたら、、ビデオ停止
                    video.pause();
                });
            }
        });

        /* ビデオクリックで再生するイベントは、一旦コメントアウトしました
        window.addEventListener('click', function () {
            video = document.querySelector('#ar-video');
            video.play();
        });
        */
    </script>
</body>
</html>
